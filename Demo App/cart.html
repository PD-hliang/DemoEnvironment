<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" http-equiv="Cache-control" content="NO-CACHE">

    <title>PhoneDuty &mdash; </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Rubik:400,700" rel="stylesheet">
    <link rel="stylesheet" href="fonts/icomoon/style.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">


    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/style.css">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    
  </head>
  <body>
  
  <div class="site-wrap">
    

    <div class="site-navbar bg-white py-2 position-relative">

      <div class="search-wrap">
        <div class="container">
          <a href="#" class="search-close js-search-close"><span class="icon-close2"></span></a>
          <form action="#" method="post">
            <input type="text" class="form-control" placeholder="Search keyword and hit enter...">
          </form>  
        </div>
      </div>

      <div class="container">
        <div class="d-flex align-items-center justify-content-between">
          <div class="logo">
            <div class="site-logo">
              <a href="index.html" class="js-logo-clone">PhoneDuty</a>
            </div>
          </div>
          <div class="main-nav d-none d-lg-block">
            <nav class="site-navigation text-right text-md-center" role="navigation">
              <ul class="site-menu js-clone-nav d-none d-lg-block">
                <li class="has-children active">
                  <a href="index.html">Collection</a>
                  <ul class="dropdown">
                    <li><a href="#">Apple Collection</a></li>
                    <li><a href="#">Android Collection</a></li>
                    <li><a href="#">Accessories</a></li>
                    
                  </ul>
                </li>
                
                <li><a href="shop.html">Shop</a></li>
                <li><a href="#">Catalogs</a></li>
                <li><a href="contact.html">Contact</a></li>
              </ul>
            </nav>
          </div>
          <div class="icons">
            <a href="#" class="icons-btn d-inline-block js-search-open"><span class="icon-search"></span></a>
            <a href="#" class="icons-btn d-inline-block"><span class="icon-heart-o"></span></a>
            <a href="cart.html" class="icons-btn d-inline-block bag">
              <span class="icon-shopping-bag"></span>
              <span class="number">2</span>
            </a>
            <a href="#" class="site-menu-toggle js-menu-toggle ml-3 d-inline-block d-lg-none"><span class="icon-menu"></span></a>
          </div>
        </div>
      </div>
    </div>
    
    <div class="bg-light py-3">
      <div class="container">
        <div class="row">
          <div class="col-md-12 mb-0"><a href="index.html">Home</a> <span class="mx-2 mb-0">/</span> <strong class="text-black">Cart</strong></div>
        </div>
      </div>
    </div>

    <div class="site-section">
      <div class="container">
        <div class="row mb-5">
          <form class="col-md-12" method="post">
            <div class="site-blocks-table">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th class="product-thumbnail">Image</th>
                    <th class="product-name">Product</th>
                    <th class="product-price">Price</th>
                    <th class="product-quantity">Quantity</th>
                    <th class="product-total">Total</th>
                    <th class="product-remove">Remove</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="product-thumbnail">
                      <img src="images/product_1.jpg" alt="Image" class="img-fluid">
                    </td>
                    <td class="product-name">
                      <h2 class="h5 text-black">Iphone XS</h2>
                    </td>
                    <td>£1000.00</td>
                    <td>
                      <div class="input-group mb-3" style="max-width: 120px;">
                        <div class="input-group-prepend">
                          <button class="btn btn-outline-primary js-btn-minus" type="button">&minus;</button>
                        </div>
                        <input type="text" class="form-control text-center" value="1" placeholder="" aria-label="Example text with button addon" aria-describedby="button-addon1">
                        <div class="input-group-append">
                          <button class="btn btn-outline-primary js-btn-plus" type="button">&plus;</button>
                        </div>
                      </div>

                    </td>
                    <td>£1000.00</td>
                    <td><a href="#" class="btn btn-primary height-auto btn-sm">X</a></td>
                  </tr>

                  <tr>
                    <td class="product-thumbnail">
                      <img src="images/product_3.jpg" alt="Image" class="img-fluid">
                    </td>
                    <td class="product-name">
                      <h2 class="h5 text-black">Airpods</h2>
                    </td>
                    <td>£79.00</td>
                    <td>
                      <div class="input-group mb-3" style="max-width: 120px;">
                        <div class="input-group-prepend">
                          <button class="btn btn-outline-primary js-btn-minus" type="button">&minus;</button>
                        </div>
                        <input type="text" class="form-control text-center" value="1" placeholder="" aria-label="Example text with button addon" aria-describedby="button-addon1">
                        <div class="input-group-append">
                          <button class="btn btn-outline-primary js-btn-plus" type="button">&plus;</button>
                        </div>
                      </div>

                    </td>
                    <td>£79.00</td>
                    <td><a href="#" class="btn btn-primary height-auto btn-sm">X</a></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </form>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="row mb-5">
              <div class="col-md-6 mb-3 mb-md-0">
                <button class="btn btn-primary btn-sm btn-block">Update Cart</button>
              </div>
              <div class="col-md-6">
                <button class="btn btn-outline-primary btn-sm btn-block">Continue Shopping</button>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <label class="text-black h4" for="coupon">Coupon</label>
                <p>Enter your coupon code if you have one.</p>
              </div>
              <div class="col-md-8 mb-3 mb-md-0">
                <input type="text" class="form-control py-3" id="coupon" placeholder="Coupon Code">
              </div>
              <div class="col-md-4">
                <button class="btn btn-primary btn-sm px-4">Apply Coupon</button>
              </div>
            </div>
          </div>
          <div class="col-md-6 pl-5">
            <div class="row justify-content-end">
              <div class="col-md-7">
                <div class="row">
                  <div class="col-md-12 text-right border-bottom mb-5">
                    <h3 class="text-black h4 text-uppercase">Cart Totals</h3>
                  </div>
                </div>
                <div class="row mb-3">
                  <div class="col-md-6">
                    <span class="text-black">Subtotal</span>
                  </div>
                  <div class="col-md-6 text-right">
                    <strong class="text-black">£1079.00</strong>
                  </div>
                </div>
                <div class="row mb-5">
                  <div class="col-md-6">
                    <span class="text-black">Total</span>
                  </div>
                  <div class="col-md-6 text-right">
                    <strong class="text-black">£1079.00</strong>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-12">
                    <button class="btn btn-primary btn-lg btn-block" onclick="completeCheckout()">Proceed To Checkout</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="site-footer custom-border-top">
      <div class="container">
        <div class="row">
          <div class="col-md-6 col-lg-3 mb-4 mb-lg-0">
            
            <div class="block-7">
              <h3 class="footer-heading mb-4">About Us</h3>
              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eius quae reiciendis distinctio voluptates sed dolorum excepturi iure eaque, aut unde.</p>
            </div>
            <div class="block-7">
              <form action="#" method="post">
                <label for="email_subscribe" class="footer-heading">Subscribe</label>
                <div class="form-group">
                  <input type="text" class="form-control py-4" id="email_subscribe" placeholder="Email">
                  <input type="submit" class="btn btn-sm btn-primary" value="Send">
                </div>
              </form>
            </div>
          </div>
          <div class="col-lg-5 ml-auto mb-5 mb-lg-0">
            <div class="row">
              <div class="col-md-12">
                <h3 class="footer-heading mb-4">Quick Links</h3>
              </div>
              <div class="col-md-6 col-lg-4">
                <ul class="list-unstyled">
                  <li><a href="#">Sell online</a></li>
                  <li><a href="#">Features</a></li>
                  <li><a href="#">Shopping cart</a></li>
                  <li><a href="#">Store builder</a></li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-4">
                <ul class="list-unstyled">
                  <li><a href="#">Mobile commerce</a></li>
                  <li><a href="#">Dropshipping</a></li>
                  <li><a href="#">Website development</a></li>
                </ul>
              </div>
              <div class="col-md-6 col-lg-4">
                <ul class="list-unstyled">
                  <li><a href="#">Point of sale</a></li>
                  <li><a href="#">Hardware</a></li>
                  <li><a href="#">Software</a></li>
                </ul>
              </div>
            </div>
          </div>
          
          <div class="col-md-6 col-lg-3">
            <div class="block-5 mb-5">
              <h3 class="footer-heading mb-4">Contact Info</h3>
              <ul class="list-unstyled">
                <li class="address">203 Fake St. Mountain View, San Francisco, California, USA</li>
                <li class="phone"><a href="tel://23923929210">+2 392 3929 210</a></li>
                <li class="email">emailaddress@domain.com</li>
              </ul>
            </div>

            
          </div>
        </div>
        <div class="row pt-5 mt-5 text-center">
          <div class="col-md-12">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" class="text-primary">Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
          </div>
          
        </div>
      </div>
    </footer>
  </div>

  <script>
  //################################################################################

  //################################################################################
  //################################################################################
  //The Main function under the button
function completeCheckout() {
  
    var customerName = "test"
    var systemRoute = ""


    var url =  window.location.pathname.split('/')


    var systemRoute = url[1]

    var serviceKey = "R012N6YPZX8OCTZPO8YG4KH2R1DX6VKP";

  
    //Clear the error pane if showing
    
    //Set the Button to something happening
    
    
    //Update the panel eventually - simulating an end system response
    
    //Get the Order Value and a Dedup key based on Customer Name and the Minute of the Button click 
    //(someone clicks multiple times = caught one)
    //They return later - we trigger a new alert 
    var orderValue = "£1079.00"
    var date = new Date();  
    dedupKey = customerName + date.getMinutes()
   // dedupKey = "NewRelicKey123"
    // Requires jQuery
    //Build the JSON payload to send
     var eventObject = '{ ' + 
        ' "client_url": "https://rpm.newrelic.com/accounts/1818495/applications/105833762", ' +
        ' "service_key"\: "' + serviceKey + '", ' +
       // ' "incident_key"\: "' + dedupKey + '", ' +
       ' "incident_key"\: "NewRelicKey123", ' +
        ' "client"\: "New Relic", ' +
        ' "vendor"\: "New Relic", ' +
        ' "event_type"\: "trigger", ' +
        ' "contexts"\: [ ' +
        ' {  ' +
            ' "src": "https://s3.eu-west-2.amazonaws.com/www.timchinchen.co.uk/DemoImages/NRErrors2.png", ' +
            ' "alt": "Snapshot of metric", ' +
            ' "href": "http://www.timchinchen.co.uk/DemoImages/NRErrors1.png", ' +
            ' "type": "image" ' +
            
        ' }, ' +
    
        ' { ' +   
        ' "text": "Conference URL (Zoom)", ' +
        ' "href": "https://pagerduty.zoom.us/j/5080555253", ' +
        ' "type": "link" ' +
        ' }, ' +
      '{' +
      '  "text": "Conference Call (Zoom)",  ' +
      '  "href": "tel:+442036950088,,5080555253#",  ' +
      '  "type": "link"  ' +
      '},' +

    '{' +
      ' "text": "Monitor Status", ' +
      ' "href": "https://appp.datadoghq.com/monitors#72563?to_ts=1452282540000&group=host%3Aprod-web-xdb09&from_ts=1452281340000", ' +
      ' "type": "link" ' +
    '},' +
    '{ ' +
    ' "text": "New Relic - Permalink", ' +
    '  "href": "https://rpm.newrelic.com/accounts/1818495/applications/105833762?tw%5Bend%5D=1518535392&tw%5Bstart%5D=1518528373", ' +
    '  "type": "link" ' +
    ' } ' +
    ' ], ' +
  ' "details": { ' +
    ' "body": "[Critical] Increased response time detected on the Checkout page affecting ' + customerName + ', High Error rates <br/> Object Reference Not Set and ADO.NET Connection pool exceeded errors detected" , ' +   
    ' "Order Value": "' + orderValue + '", ' +
    ' "priority": "High", ' +
    ' "title": "[Critical] Increased response time detected on the Checkout page, High Error rates  affecting ' + customerName + '", ' +
    ' "event_id": "8125363154448140714", ' +
    ' "tags": "aws-prod, base, env:prod, host:farnsworth, monitor, pd_az:us-west-2c, production, xdb, xtradb", ' +
    ' "Customer": "'+ customerName + '", ' +
    ' "SystemRoute": "' + systemRoute + '"'+
        ' }, ' +
  ' "description": "[Critical] Increased response time detected on the Checkout page, High Error rates" ' +
  '}' 

  console.log(eventObject)


    //Send!!!
    $.ajax({
      method: "POST",
      url: "https://events.pagerduty.com/generic/2010-04-15/create_event.json",
      data: eventObject
    })
      .done(function( msg ) {
        //alert( "Data Saved: " + msg );
    });

   

    //Update the panel eventually - simulating an end system response
    setTimeout(sendZabbix, 2000);
    //Update the panel eventually - simulating an end system response
    setTimeout(sendLowRevenueWarning, 2500);

    setTimeout(sendImpactMetrics,3000);

     setTimeout(function(){ 

      window.location.href = "error.html";

}, 3500)



  }


///////////////////////////////

function sendImpactMetrics(){

   console.log('Impact metrics');


$.post('http://ec2-3-81-133-156.compute-1.amazonaws.com:8080/break');

      console.log("success?")
      
}





 //################################################################################
 function sendZabbix()
  {

    var systemRoute = ""

    var url =  window.location.pathname.split('/')

    console.log(window.location.pathname);
    console.log(url.length)
    var systemRoute = url[1]

    var serviceKey = "R012N6YPZX8OCTZPO8YG4KH2R1DX6VKP";

 
    // console.log('Send to Zabbix');
    
    // var route = document.getElementById("coupon").value;
    // var systemRoute = ""
    // //Grab the Service key of use Tim's default one!


    // var serviceKey = "d05476d915b34624a4ffc84e13055cfa";

    // if(route.length > 0){
    //   serviceKey = "R012LD8W8HAX90E4MRF3LWWRA0HGKBON"
    //   systemRoute = route
    // }
    //Grab the Service key of use Tim's default one!
   
    var eventObject = ' { ' +
    '   "payload": {     ' +
    '     "summary": "java.lang.OutOfMemoryError: Java heap space",   ' +
    '     "source": "Zabbix",   ' +
    '     "severity": "warning",   ' +
    '     "location" : "prod",   ' +
    '     "component": "Zabbix",   ' +
    '     "group": "Zabbix,Production,eCommerce,Checkout-Tier",   ' +
    '     "class": "Zabbix" },   ' +
    '     "routing_key": "' + serviceKey + '",   ' +
    '     "dedup_key": "Zabbixdedupkey",   ' +
    '     "event_action": "trigger",   ' +
    '     "client": "View in Zabbix",   ' +
    '     "client_url": "www.zabbix.com",   ' +
    '     "SystemRoute": "' + systemRoute + '",' +
    '     "images": [   ' +
    '         {   ' +
    '           "src": "https://chart.googleapis.com/chart?chs=600x400&chd=t:6,2,9,5,2,5,7,4,8,2,1&cht=lc&chds=a&chxt=y&chm=D,0033FF,0,0,5,1",   ' +
    '           "href": "https://acme.pagerduty.com",   ' +
    '           "alt": "This is a sample link"  ' +
    '       }  ' +
    '     ]  ' +
    '   }'
    console.log(eventObject);
    $.ajax({
      method: "POST",
      url: "https://events.pagerduty.com/v2/enqueue",
      data: eventObject
    })
      .done(function( msg ) {
        //alert( "Data Saved: " + msg );
    });
    return;
  }
  //################################################################################
//################################################################################
function sendLowRevenueWarning()
  {
    console.log('Send Low Revenue Warning');
    
    //Grab the Service key of use Tim's default one!
    
   // var route = document.getElementById("coupon").value;
   

    var systemRoute = ""

    var url =  window.location.pathname.split('/')
    var systemRoute = url[1]

    var serviceKey = "R012N6YPZX8OCTZPO8YG4KH2R1DX6VKP";



    var eventObject = ' { ' +
    '   "payload": {     ' +
    '     "summary": "Low Revenue detected compared to normal",   ' +
    '     "source": "Prometheus",   ' +
    '     "severity": "warning",   ' +
    '     "location" : "prod",   ' +
    '     "component": "Prometheus",   ' +
    '     "group": "Prometheus,Production,eCommerce,Checkout-Tier",   ' +
    '     "class": "Prometheus" },   ' +
    '     "routing_key": "' + serviceKey + '",   ' +
    '     "dedup_key": "Prometheusdedupkey",   ' +
    '     "event_action": "trigger",   ' +
    '     "client": "View in Prometheus",   ' +
    '     "client_url": "www.Prometheus.com",   ' +
    '     "SystemRoute": "' + systemRoute + '",' +
    '     "images": [   ' +
    '         {   ' +
    '           "src": "https://logz.io/wp-content/uploads/2017/03/memory-graph.png",   ' +
    '           "href": "https://logz.io/wp-content/uploads/2017/03/memory-graph.png",   ' +
    '           "alt": "This is a sample link"  ' +
    '       }  ' +
    '     ]  ' +
    '   }'
    console.log(eventObject);
    $.ajax({
      method: "POST",
      url: "https://events.pagerduty.com/v2/enqueue",
      data: eventObject
    })
      .done(function( msg ) {
        //alert( "Data Saved: " + msg );
    });
    return;
  }
  //################################################################################
  </script>

  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/jquery-ui.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/aos.js"></script>

  <script src="js/main.js"></script>
    
  </body>
</html>